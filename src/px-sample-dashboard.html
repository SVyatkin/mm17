<link rel="import" href="../bower_components/polymer/polymer.html" />

<!-- Predix components used by this app view -->
<link rel="import" href="../bower_components/px-card/px-card.html" />
<link rel="import" href="../bower_components/px-simple-bar-chart/px-simple-bar-chart.html" />
<link rel="import" href="../bower_components/px-key-value-pair/px-key-value-pair.html" />
<link rel="import" href="../bower_components/px-kpi/px-kpi.html" />
<link rel="import" href="../bower_components/px-gauge/px-gauge.html" />
<link rel="import" href="../bower_components/px-card/px-card.html" />
<link rel="import" href="../bower_components/px-map/px-map.html" />
<link rel="import" href="../bower_components/px-map/px-map-tile-layer.html" />
<link rel="import" href="../bower_components/px-map/px-map-marker-group.html" />
<link rel="import" href="../bower_components/px-map/px-map-marker-symbol.html" />
<link rel="import" href="../bower_components/px-slider/px-slider.html" />
<link rel="import" href="../bower_components/px-modal/px-modal.html" />
<link rel="import" href="../bower_components/px-vis-timeseries/px-vis-timeseries.html" />
<link rel="import" href="/bower_components/px-icon-set/px-icon-set.html" /> 
<link rel="import" href="/bower_components/px-icon-set/px-icon.html" />


<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html" />

<!-- Load styles -->
<link rel="import" href="../css/px-sample-app-styles.html" />

<dom-module id="px-sample-dashboard">
  <template>
    <style include="px-sample-app-styles"></style>

    <div class="spine u-pt">
      <span class="heading--page u-p">{{title}}</span>
      <div class="flex flex--wrap flex--justify">
        <px-key-value-pair class="kpi1 u-p" key="Cost of Investment" value=[[_costOfInvestment]] uom="$ in Millions" size="beta"></px-key-value-pair>
        <px-modal btn-modal-positive="BACK">
          <px-key-value-pair class="kpi2 u-p modal-trigger" key="Power Consumption" value=[[_powerConsumption]] uom="GWh/yr" size="beta"></px-key-value-pair>

          <px-card class="light-card" header-text="Solar Installations" icon="px-fea:products">
            <px-vis-timeseries debounce-resize-timing="250" width="700" height="296" chart-horizontal-alignment="center" chart-vertical-alignment="center"
              margin='{"top":30,"bottom":60,"left":65,"right":65}' register-config='{"type":"horizontal"}' selection-type="xy"
              chart-data="[[chartData]]" series-config='{"y0":{"name":"y0","x":"timeStamp","y":"y0","yAxisUnit":"F","axis":{"id":"axis1","side":"left","number":"1"}},"y1":{"name":"y1","x":"timeStamp","y":"y1","yAxisUnit":"Hz","axis":{"id":"axis2","side":"right","number":"1"}},"y2":{"name":"y2","x":"timeStamp","y":"y2","yAxisUnit":"C","axis":{"id":"axis3","side":"left","number":"2"}},"y3":{"name":"y3","x":"timeStamp","y":"y3","yAxisUnit":"F","axis":{"id":"axis4","side":"right","number":"2"}}}'
              chart-extents='{"x":["dynamic","dynamic"],"y":["dynamic","dynamic"]}' x-axis-config='{"title":"Date"}' y-axis-config='{"title":"Single","titleTruncation":false,"unit":"F","axis1":{"title":"Temperature","titleTruncation":false,"unit":"C"}}'
              disable-navigator>
            </px-vis-timeseries>
          </px-card>
        </px-modal>

        <px-key-value-pair class="kpi3 u-p" key="Renewable Output" value=[[_renewableOutput]] uom="GWh" size="beta"></px-key-value-pair>
        <px-key-value-pair class="kpi4 u-p" key="Carbon Offset" value=[[_carbonOffset]] uom="GWh" size="beta"></px-key-value-pair>
      </div>
    </div>

    <px-card class="light-card" header-text="Carbon Nuetrality Goal Year" icon="px-fea:products">
      <div class="">
        <px-slider value={{_carbonNuetralDate}} end-value="2100" min="2017" max="2100" step="1" scale="linear" base="10" exponent="2" min-label-position="bottom"
          max-label-position="bottom"></px-slider>
      </div>
    </px-card>

    <!-- This last px-card includes a px-map. -->
    <iron-ajax url="/data/solar_permits.json" handle-as="json" last-response="{{mapData}}" auto></iron-ajax>
    <iron-ajax id="savingsCalc" url="" handle-as="json" last-response="{{_savingsResponse}}" on-response="handleSavingsResponse" auto></iron-ajax>
    <px-card class="light-card" header-text="Solar Installations" icon="px-fea:products">
      <div class='actions'>
        <px-icon icon='px-utl:app-settings'></px-icon>
      </div>
      <div class="flex flex--row">
        <div style="flex:0 0 25%;">
          <span class="u-p">New Residential Installs (%)</span>
          <px-slider value={{_residentialSliderPercentage}} end-value="100" min="0" max="100" step="5" scale="linear" base="10" exponent="2" min-label-position="bottom"
            max-label-position="bottom" on-value-changed="updateMap"></px-slider>

          <span class="u-p">New Commercial Installs (%)</span>
          <px-slider value={{_commercialSliderPercentage}} end-value="100" min="0" max="100" step="5" scale="linear" base="10" exponent="2" min-label-position="bottom"
            max-label-position="bottom" on-value-changed="updateMap"></px-slider>

          <span class="u-p">New Industrial Installs (%)</span>
          <px-slider value={{_industrialSliderPercentage}} end-value="100" min="0" max="100" step="5" scale="linear" base="10" exponent="2" min-label-position="bottom"
            max-label-position="bottom" on-value-changed="updateMap"></px-slider>
        </div>
        <div style="flex:0 0 75%;">
          <px-map style="height:500px;" zoom="11" lat="32.716089" lng="-117.164744" flex-to-size disable-scroll-zoom>
            <px-map-marker-group id="markers" name="solar" data="{{_mapData}}"></px-map-marker-group>
            <px-map-tile-layer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png">
            </px-map-tile-layer>
          </px-map>
        </div>
      </div>
    </px-card>

    <!-- By placing several px-key-value-pairs in a flex container, we can easily create a "spine" which is a term
         we use for a row of KPIs or other high level information about an asset on the top of a dashboard. -->

    <px-card class="light-card" header-text="Estimated Solar Installations By Income" icon="px-vis:closest-point-series">        
      <!-- <div class="spine u-pt"> -->
        <div class="flex flex--justify">
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi1 u-p" key="Less than $10,000" value=[[_inc1Perc]] uom="%" size="delta"></px-key-value-pair>              
              <px-key-value-pair class="kpi1 u-p" value=[[_inc1]] uom="People" size="delta"></px-key-value-pair>              
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi2 u-p" key="$10,000 to $14,999" value=[[_inc2Perc]] uom="%" size="delta"></px-key-value-pair>              
              <px-key-value-pair class="kpi2 u-p" value=[[_inc2]] uom="People" size="delta"></px-key-value-pair>              
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi3 u-p" key="$15,000 to $24,999" value=[[_inc3Perc]] uom="%" size="delta"></px-key-value-pair>              
              <px-key-value-pair class="kpi3 u-p" value=[[_inc3]] uom="People" size="delta"></px-key-value-pair>              
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi4 u-p" key="$25,000 to $34,999" value=[[_inc4Perc]] uom="%" size="delta"></px-key-value-pair>
              <px-key-value-pair class="kpi4 u-p" value=[[_inc4]] uom="People" size="delta"></px-key-value-pair>              
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi5 u-p" key="$35,000 to $49,999" value=[[_inc5Perc]] uom="%" size="delta"></px-key-value-pair>
              <px-key-value-pair class="kpi5 u-p" value=[[_inc5]] uom="People" size="delta"></px-key-value-pair>              
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi6 u-p" key="$50,000 to $74,999" value=[[_inc6Perc]] uom="%" size="delta"></px-key-value-pair>
              <px-key-value-pair class="kpi6 u-p" value=[[_inc6]] uom="People" size="delta"></px-key-value-pair>              
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi7 u-p" key="$75,000 to $99,999" value=[[_inc7Perc]] uom="%" size="delta"></px-key-value-pair>
              <px-key-value-pair class="kpi7 u-p" value=[[_inc7]] uom="People" size="delta"></px-key-value-pair>    
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi8 u-p" key="$100,000 to $149,999" value=[[_inc8Perc]] uom="%" size="delta"></px-key-value-pair>              
              <px-key-value-pair class="kpi8 u-p" value=[[_inc8]] uom="People" size="delta"></px-key-value-pair>
          </div>
          <div>
              <px-icon class="center-icon" icon="px-nav:generic-user"></px-icon>
              <px-key-value-pair class="kpi9 u-p" key="$150,000+" value=[[_inc9Perc]] uom="%" size="delta"></px-key-value-pair>
              <px-key-value-pair class="kpi9 u-p" value=[[_inc9]] uom="People" size="delta"></px-key-value-pair>              
          </div>
      <!-- </div> -->
    </px-card>
        

  </template>
</dom-module>
<script src="px-sample-dashboard.js"></script>
